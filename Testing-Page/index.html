<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>The Output Mechanic GoodBlock</title>
    <!-- FIXED: Correct Tailwind Script -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- BRANDING CONFIGURATION -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'allgood-primary': '#D34716', // Burnt Orange
                        'allgood-secondary': '#357889', // Deep Cyan
                        'allgood-dark': '#4C4C4C', // Dark Gray
                        'allgood-light': '#F7F7F7', // Light Gray
                        'allgood-hover': '#EB8D69', 
                        'allgood-accent': '#2D6473',
                    },
                    fontFamily: {
                        'heading': ['Georgia', 'serif'],
                        'body': ['Verdana', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        'pulse-success': {
                            '0%': { transform: 'scale(1)', boxShadow: '0 0 0 rgba(34, 197, 94, 0)' },
                            '50%': { transform: 'scale(1.1)', boxShadow: '0 0 20px rgba(34, 197, 94, 0.6)' },
                            '100%': { transform: 'scale(1)', boxShadow: '0 0 0 rgba(34, 197, 94, 0)' }
                        },
                        'surge-beam': {
                            '0%': { width: '0%', filter: 'brightness(1)' },
                            '50%': { width: '100%', filter: 'brightness(2)' },
                            '100%': { width: '100%', filter: 'brightness(1)' }
                        },
                        'flash-fade': {
                            '0%': { opacity: '0', transform: 'translate(-50%, -40%) scale(0.9)' },
                            '20%': { opacity: '1', transform: 'translate(-50%, -50%) scale(1)' },
                            '80%': { opacity: '1', transform: 'translate(-50%, -50%) scale(1)' },
                            '100%': { opacity: '0', transform: 'translate(-50%, -60%) scale(1.1)' }
                        }
                    }
                },
            },
        }
    </script>

    <style>
        /* CORE OS STYLES */
        body {
            font-family: Verdana, sans-serif;
            background-color: #1a1a1a;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            background-attachment: fixed;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            touch-action: none; /* Prevent scrolling rubber-banding */
        }

        h1, h2, h3, h4, h5, h6 { font-family: Georgia, serif; }

        .tablet-frame {
            height: 80vh;
            width: auto;
            aspect-ratio: 16/10; 
            max-width: 1100px;
            max-height: 95vh;
            background-image: 
                radial-gradient(circle at 0% 0%, rgba(211, 71, 22, 0.35) 0%, transparent 30%),
                radial-gradient(circle at 100% 100%, rgba(211, 71, 22, 0.35) 0%, transparent 30%),
                linear-gradient(135deg, #5c5c5c 0%, #d6d6d6 25%, #8a8a8a 50%, #e0e0e0 75%, #5c5c5c 100%);
            border-radius: 12px;
            padding: 12px; 
            box-shadow: inset 1px 1px 2px rgba(255,255,255, 0.6), inset -1px -1px 2px rgba(0,0,0, 0.8), 0 30px 60px -12px rgba(0, 0, 0, 0.8), 0 0 0 1px #111;
            border: 1px solid #333;
            position: relative;
            margin: 20px auto;
            transition: all 0.3s ease;
        }

        .tablet-frame::before {
            content: '';
            position: absolute;
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            border-radius: 6px;
            background: #111;
            z-index: 0;
        }

        .screen-container {
            width: 100%;
            height: 100%;
            background-color: #F7F7F7;
            position: relative;
            z-index: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column; 
            border-radius: 4px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }

        /* Fullscreen Mode */
        .tablet-frame.focus-mode {
            position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important;
            max-width: none !important; max-height: none !important; margin: 0 !important; padding: 0 !important; border-radius: 0 !important;
            z-index: 9999 !important;
            background-image: none !important; border: none !important;
        }
        .tablet-frame.focus-mode::before { display: none; }
        .tablet-frame.focus-mode .screen-container { border-radius: 0; }

        /* Blueprint Mode */
        .blueprint-mode .screen-container { background-color: #0f172a !important; color: #94a3b8 !important; }
        .blueprint-mode .bg-white { background-color: #1e293b !important; color: #cbd5e1 !important; border-color: #334155 !important; }
        .blueprint-mode h1, .blueprint-mode h2, .blueprint-mode h3, .blueprint-mode strong { color: #38bdf8 !important; }
        .blueprint-mode .text-allgood-dark { color: #e2e8f0 !important; }
        .blueprint-mode .bg-gray-50, .blueprint-mode .bg-gray-100 { background-color: #0f172a !important; }
        .blueprint-mode .mentor-bar { background-color: #1e293b !important; border-color: #334155 !important; }
        .blueprint-mode .mentor-text { color: #cbd5e1 !important; }

        /* Navigation & Layout */
        .page { width: 100%; height: 100%; padding: 16px; display: none; overflow: hidden; flex-direction: column; }
        .page.active { display: flex; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* INTERACTIVE ELEMENTS */
        
        /* Page 4: Circuit Breaker */
        .circuit-slot {
            width: 110px; height: 110px; border: 3px dashed #cbd5e1; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            transition: background-color 0.3s, border-color 0.3s; background: rgba(255,255,255,0.5);
        }
        .circuit-slot.drag-over { border-color: #357889; background: #e0f2fe; transform: scale(1.05); }
        .power-cable {
            height: 16px; background: #333; width: 100%; border-radius: 8px; margin: 20px 0;
            position: relative; overflow: hidden;
        }
        .power-beam {
            position: absolute; top: 0; left: 0; height: 100%; width: 0%;
            background: linear-gradient(90deg, #D34716, #fb923c);
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px #D34716;
        }
        
        /* New Flash Message Style */
        .flash-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.85);
            color: #4ade80; /* Green-400 */
            padding: 16px 32px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 14px;
            letter-spacing: 2px;
            border: 1px solid #4ade80;
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.3);
            pointer-events: none;
            opacity: 0;
            z-index: 50;
            text-align: center;
            white-space: nowrap;
        }
        
        /* Updated Draggables for Touch/Pointer Events */
        .draggable-orb {
            cursor: grab; 
            touch-action: none; /* Critical for touch drag */
            position: relative;
            z-index: 10;
            transform: scale(1.1); /* Slightly larger by default */
        }
        .draggable-orb:active { cursor: grabbing; }
        .draggable-orb.dragging { z-index: 100; opacity: 0.8; }

        /* Page 5: Fear Loadout */
        .backpack-slot {
            transition: all 0.3s;
        }
        .backpack-slot.drag-over { transform: scale(1.05); filter: brightness(1.2); border: 2px solid #357889; }
        
        .fear-item { 
            animation: float 3s ease-in-out infinite; 
            cursor: grab;
            touch-action: none;
            position: relative;
            z-index: 10;
        }
        .fear-item.dragging { animation: none; z-index: 100; }

        /* Page 6: Evidence Stack */
        .evidence-bar {
            width: 100%; background: #e2e8f0; border-radius: 4px; overflow: hidden; height: 30px; position: relative;
        }
        .evidence-fill {
            height: 100%; background: #357889; width: 0%; transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* Utilities */
        .hidden-modal { opacity: 0; pointer-events: none; transform: translateY(-10px); }
        .visible-modal { opacity: 1; pointer-events: auto; transform: translateY(0); }
        .modal-transition { transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out; }

    </style>
</head>
<body class="flex flex-col min-h-screen text-allgood-dark font-body overflow-hidden">

    <main class="flex-grow flex items-center justify-center py-8">
        <div class="tablet-frame" id="main-frame">
            <div class="screen-container">
            
                <!-- 1. STARTUP SCREEN -->
                <div id="startup-screen" class="absolute inset-0 z-[300] flex flex-col items-center justify-center cursor-pointer transition-opacity duration-700 ease-in-out bg-gradient-to-br from-allgood-secondary to-gray-900">
                    <div class="group flex flex-col items-center justify-center text-center h-full w-full relative">
                        <div class="flex-grow flex flex-col items-center justify-center px-4">
                            <div class="relative">
                                <div class="absolute inset-0 bg-white/10 blur-3xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-700"></div>
                                <i data-lucide="factory" class="w-24 h-24 text-white mb-6 relative z-10 drop-shadow-[0_0_15px_rgba(255,255,255,0.5)]"></i>
                                <h2 class="text-xl md:text-2xl font-heading font-bold text-gray-300 mb-1 relative z-10 tracking-widest uppercase">Allgood Academy</h2>
                                <h1 class="text-5xl md:text-7xl font-heading font-bold text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-400 tracking-tighter relative z-10 drop-shadow-sm">GoodBlock</h1>
                                <p class="mt-4 text-allgood-primary font-bold text-lg relative z-10 bg-white/10 px-4 py-1 rounded-full backdrop-blur-sm border border-white/10">The Output Mechanic</p>
                            </div>
                            <p class="mt-16 text-white/60 text-xs tracking-[0.4em] uppercase font-bold group-hover:text-white transition-colors animate-pulse">CLICK TO POWER UP</p>
                        </div>
                    </div>
                </div>

                <!-- 2. Header (Navigation & Controls) -->
                <header class="bg-allgood-secondary shadow-md flex-none h-[60px] flex items-center z-20 relative">
                    <div class="w-full px-4 flex items-center justify-between h-full">
                        <div class="flex items-center overflow-hidden">
                            <div id="header-welcome-text" class="text-white font-heading font-bold text-lg tracking-tight truncate mr-4 select-none">Welcome, Billy</div>
                            <div class="flex shrink-0 items-center bg-black/20 rounded-full px-3 py-1 border border-white/10 shadow-inner backdrop-blur-sm">
                                <span class="text-[10px] uppercase tracking-wider text-white/60 mr-2 font-heading font-bold">Page</span>
                                <span id="header-page-indicator" class="text-xs font-bold text-white font-body tabular-nums">1 / 8</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-1 shrink-0 relative">
                            <!-- Control Cluster -->
                            <button id="home-button" onclick="goHome()" class="text-gray-200 hover:text-white transition-colors p-2 rounded-full hover:bg-white/10 mr-2"><i data-lucide="home" class="w-6 h-6"></i></button>
                            <div class="h-6 w-px bg-white/20 mx-1"></div>
                            <button onclick="toggleBlueprint()" class="text-gray-200 hover:text-cyan-300 transition-colors p-2 rounded-full hover:bg-white/10"><i data-lucide="moon" class="w-5 h-5"></i></button>
                            <button onclick="toggleFullscreen()" class="text-gray-200 hover:text-green-300 transition-colors p-2 rounded-full hover:bg-white/10"><i data-lucide="maximize" class="w-5 h-5"></i></button>
                            <button onclick="toggleMenu()" class="text-gray-200 hover:text-white transition-colors p-2 rounded-full hover:bg-white/10"><i data-lucide="menu" class="w-7 h-7"></i></button>
                        </div>
                    </div>
                </header>

                <!-- MAIN SCROLL VIEW (NO SCROLLING ALLOWED) -->
                <div id="main-scroll-view" class="flex-1 min-h-0 overflow-hidden w-full relative bg-[#F7F7F7] flex flex-col">

                    <!-- MENTOR BAR (Horizontal) -->
                    <div id="mentor-bar" class="w-full bg-gray-50 border-b border-gray-200 px-6 py-4 flex items-start gap-4 transition-opacity duration-300 shrink-0 z-10 mentor-bar">
                        <div class="mt-0.5 shrink-0">
                            <i data-lucide="lightbulb" class="w-5 h-5 text-allgood-primary"></i>
                        </div>
                        <div class="flex-1">
                            <p id="mentor-text" class="text-sm font-medium text-gray-700 leading-relaxed font-body mentor-text">System online. Let's look under the hood of your confidence engine.</p>
                        </div>
                    </div>

                    <!-- PAGES CONTAINER -->
                    <div class="flex-grow relative h-full">

                        <!-- PAGE 1: COVER -->
                        <div class="page active" id="page-1">
                            <div class="flex flex-col items-center justify-center text-center h-full">
                                <div class="mb-6 relative scale-125">
                                    <div class="w-48 h-48 rounded-2xl border-4 border-dashed border-gray-300 flex flex-col items-center justify-center bg-gray-50 p-4">
                                        <i data-lucide="settings" class="w-16 h-16 text-gray-300 animate-spin-slow mb-2" style="animation-duration: 10s"></i>
                                        <i data-lucide="zap" class="w-12 h-12 text-allgood-primary"></i>
                                    </div>
                                </div>
                                <h1 class="text-3xl md:text-4xl font-heading font-bold text-allgood-dark mb-4 mt-6">The Output<br><span class="text-allgood-secondary">Mechanic</span></h1>
                                <p class="text-sm text-gray-500 max-w-xs mx-auto leading-relaxed mb-8">Stop waiting for the feeling. Learn the engineering behind unshakeable confidence.</p>
                                <button onclick="nextPage()" class="px-8 py-3 bg-allgood-dark text-white rounded-full font-bold text-sm hover:bg-black transition-transform hover:scale-105 shadow-lg flex items-center gap-2 mx-auto">
                                    OPEN THE HOOD <i data-lucide="arrow-right" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>

                        <!-- PAGE 2: THE BROKEN MODEL (Overhauled) -->
                        <div class="page" id="page-2">
                            <div class="flex flex-col items-center justify-center h-full bg-gray-50">
                                <h2 class="text-2xl font-heading font-bold text-allgood-dark mb-4 text-center">The Broken Engine</h2>
                                
                                <!-- Card Container with High Contrast and Density -->
                                <div class="relative w-full max-w-md bg-white rounded-2xl shadow-xl border border-gray-300 p-6 flex flex-col items-center justify-between gap-6 transform scale-100">
                                    
                                    <!-- Input Section -->
                                    <div class="w-full flex items-center gap-4 bg-gray-50 p-4 rounded-lg border border-gray-200">
                                        <div class="flex flex-col items-center gap-1 min-w-[60px]">
                                            <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">INPUT</span>
                                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 border border-blue-200">
                                                <i data-lucide="message-square" class="w-5 h-5"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <div class="text-sm font-bold text-allgood-dark">"I am confident"</div>
                                            <div class="text-xs text-gray-500">Affirmation / Intention</div>
                                        </div>
                                    </div>

                                    <!-- The Machine (Stalled) -->
                                    <div class="w-full flex items-center justify-center py-2 relative">
                                        <div class="relative">
                                            <i data-lucide="cog" class="w-24 h-24 text-gray-300 animate-[spin_4s_linear_infinite]" style="animation-play-state: paused;"></i>
                                            <div class="absolute inset-0 flex items-center justify-center">
                                                <div class="bg-white rounded-full p-2 shadow-sm border border-red-200">
                                                    <i data-lucide="x" class="w-10 h-10 text-red-500"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Connection Lines -->
                                        <div class="absolute left-1/2 top-0 h-full w-px bg-gray-300 -z-10"></div>
                                    </div>

                                    <!-- Output Section -->
                                    <div class="w-full flex items-center gap-4 bg-red-50 p-4 rounded-lg border border-red-100 opacity-80">
                                        <div class="flex flex-col items-center gap-1 min-w-[60px]">
                                            <span class="text-[10px] font-bold text-red-400 uppercase tracking-widest">OUTPUT</span>
                                            <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-red-400 border border-red-200">
                                                <i data-lucide="ban" class="w-5 h-5"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <div class="text-sm font-bold text-red-800">No Action</div>
                                            <div class="text-xs text-red-600">System Stalled</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <p class="mt-6 text-sm text-center text-gray-600 max-w-xs font-medium bg-white px-4 py-2 rounded-full border border-gray-200 shadow-sm">Most people try to <b>think</b> their way into acting. This loop never closes.</p>
                            </div>
                        </div>

                        <!-- PAGE 3: THE FLIP -->
                        <div class="page" id="page-3">
                            <div class="flex flex-col items-center justify-center h-full">
                                <h2 class="text-2xl font-heading font-bold text-allgood-dark mb-4 text-center">The Real Mechanic</h2>
                                
                                <div class="w-full max-w-md bg-allgood-dark text-white rounded-xl p-6 shadow-xl relative overflow-hidden transform scale-95">
                                    <div class="absolute top-0 right-0 p-4 opacity-10">
                                        <i data-lucide="cpu" class="w-20 h-20"></i>
                                    </div>
                                    
                                    <div class="flex items-center gap-4 mb-4">
                                        <div class="w-8 h-8 rounded-full bg-allgood-primary flex items-center justify-center font-bold text-sm shadow-md border border-white/20">1</div>
                                        <p class="text-lg font-bold">Do the Scary Thing</p>
                                    </div>
                                    <div class="h-8 w-0.5 bg-gray-600 ml-4 mb-2"></div>
                                    
                                    <!-- STEP 2 - Hidden Initially -->
                                    <div class="flex items-center gap-4 mb-4 opacity-0 transition-opacity duration-1000" id="step-2">
                                        <div class="w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center font-bold text-sm transition-colors duration-500 shadow-md border border-white/20" id="step-2-circle">2</div>
                                        <p class="text-lg font-bold">Survive</p>
                                    </div>
                                    <div class="h-8 w-0.5 bg-gray-600 ml-4 mb-2"></div>

                                    <!-- STEP 3 - Hidden Initially -->
                                    <div class="flex items-center gap-4 opacity-0 transition-opacity duration-1000 delay-500" id="step-3">
                                        <div class="w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center font-bold text-sm transition-colors duration-500 shadow-md border border-white/20" id="step-3-circle">3</div>
                                        <p class="text-lg font-bold text-allgood-secondary text-cyan-300">Feel Confident</p>
                                    </div>
                                </div>

                                <button id="diag-btn" onclick="animateFlip()" class="mt-4 px-8 py-3 border-2 border-allgood-primary text-allgood-primary rounded-lg font-bold text-sm uppercase tracking-widest hover:bg-allgood-primary hover:text-white transition-colors shadow-sm">
                                    Run Diagnostics
                                </button>
                            </div>
                        </div>

                        <!-- PAGE 4: INTERACTIVE CIRCUIT -->
                        <div class="page" id="page-4">
                            <div class="flex flex-col items-center justify-center h-full relative"> <!-- Added relative for flash positioning -->
                                <div class="w-full max-w-md bg-white rounded-xl border border-gray-200 shadow-lg p-6 relative transform scale-105 overflow-hidden"> <!-- Overflow hidden for safety -->
                                    <h3 class="font-heading font-bold text-xl text-center mb-6 text-allgood-dark">Power The System</h3>
                                    
                                    <!-- Flash Message Container -->
                                    <div id="flash-message" class="flash-overlay">ACTION INPUT RECEIVED</div>

                                    <!-- The Machine -->
                                    <div class="flex justify-between items-center mb-2 relative px-2"> <!-- Reduced margin-bottom -->
                                        <!-- Input Slot -->
                                        <div class="circuit-slot flex-col gap-2 shadow-inner" id="input-slot">
                                            <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">Input</span>
                                            <div class="w-12 h-12 border-2 border-gray-300 rounded-full flex items-center justify-center bg-gray-50">
                                                <i data-lucide="arrow-down" class="w-5 h-5 text-gray-300"></i>
                                            </div>
                                        </div>

                                        <!-- Cable -->
                                        <div class="flex-1 px-4 h-16 flex items-center">
                                            <div class="w-full h-3 bg-gray-800 rounded-full overflow-hidden relative shadow-inner border border-gray-700">
                                                <div id="power-beam" class="power-beam"></div>
                                            </div>
                                        </div>

                                        <!-- Output Gauge -->
                                        <div class="flex flex-col items-center"> <!-- Wrapper for Gauge + Status -->
                                            <div class="w-24 h-24 rounded-full border-[6px] border-gray-200 flex flex-col items-center justify-center transition-colors duration-500 bg-white z-10 shadow-md relative" id="output-gauge">
                                                <span class="text-2xl font-bold text-gray-300 transition-colors duration-300" id="output-val">0%</span>
                                                <span class="text-[9px] font-bold text-gray-400 uppercase tracking-wide transition-colors duration-300" id="output-label">Output</span>
                                            </div>
                                            <!-- System Status Text (Moved Here) -->
                                            <div id="system-status" class="mt-2 text-center text-[10px] font-bold uppercase tracking-widest text-gray-400 transition-colors duration-300 h-4">
                                                System Offline
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Draggables -->
                                    <div class="bg-gray-50 rounded-lg p-4 flex justify-around items-center border border-gray-200 relative shadow-inner mt-4">
                                        <div class="draggable-orb flex flex-col items-center gap-2 transition-transform hover:scale-110" data-type="thought">
                                            <div class="w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center text-2xl shadow-md border border-blue-200 pointer-events-none">üí≠</div>
                                            <span class="text-[10px] font-bold text-blue-800 bg-blue-50 px-3 py-1 rounded-full pointer-events-none border border-blue-100">Affirmations</span>
                                        </div>

                                        <div class="draggable-orb flex flex-col items-center gap-2 transition-transform hover:scale-110" data-type="action">
                                            <div class="w-14 h-14 bg-orange-100 rounded-full flex items-center justify-center text-2xl shadow-md border border-orange-200 pointer-events-none">‚ö°Ô∏è</div>
                                            <span class="text-[10px] font-bold text-orange-800 bg-orange-50 px-3 py-1 rounded-full pointer-events-none border border-orange-100">Action</span>
                                        </div>
                                    </div>
                                    
                                    <div id="circuit-feedback" class="text-sm text-center mt-4 text-gray-400 italic font-medium h-10 flex items-center justify-center"> <!-- Fixed height container -->
                                        Drag an item to the Input slot.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- PAGE 5: EVIDENCE LOG -->
                        <div class="page" id="page-5">
                            <div class="flex flex-col items-center justify-center h-full">
                                <h2 class="text-2xl font-heading font-bold text-allgood-dark mb-2">Data Over Dopamine</h2>
                                <p class="text-sm text-gray-500 mb-6 text-center max-w-xs">Your brain lies. The data doesn't. <br>Log the reps to build the proof.</p>

                                <div class="w-full max-w-sm space-y-3 transform scale-100">
                                    <!-- Item 1 -->
                                    <div class="bg-white p-3 rounded-xl shadow-md border border-gray-200 flex items-center justify-between group cursor-pointer transition-all hover:border-allgood-secondary hover:shadow-lg hover:-translate-y-1" onclick="logEvidence(this)">
                                        <div class="flex items-center gap-4">
                                            <div class="w-6 h-6 rounded border-2 border-gray-300 flex items-center justify-center transition-colors bg-gray-50">
                                                <i data-lucide="check" class="w-4 h-4 text-white opacity-0 transition-opacity stroke-[3]"></i>
                                            </div>
                                            <span class="text-base font-bold text-gray-600">Sent the scary email</span>
                                        </div>
                                        <span class="text-xs font-mono text-gray-400 bg-gray-100 px-2 py-1 rounded">+10XP</span>
                                    </div>

                                    <!-- Item 2 -->
                                    <div class="bg-white p-3 rounded-xl shadow-md border border-gray-200 flex items-center justify-between group cursor-pointer transition-all hover:border-allgood-secondary hover:shadow-lg hover:-translate-y-1" onclick="logEvidence(this)">
                                        <div class="flex items-center gap-4">
                                            <div class="w-6 h-6 rounded border-2 border-gray-300 flex items-center justify-center transition-colors bg-gray-50">
                                                <i data-lucide="check" class="w-4 h-4 text-white opacity-0 transition-opacity stroke-[3]"></i>
                                            </div>
                                            <span class="text-base font-bold text-gray-600">Spoke up in meeting</span>
                                        </div>
                                        <span class="text-xs font-mono text-gray-400 bg-gray-100 px-2 py-1 rounded">+10XP</span>
                                    </div>

                                    <!-- Item 3 -->
                                    <div class="bg-white p-3 rounded-xl shadow-md border border-gray-200 flex items-center justify-between group cursor-pointer transition-all hover:border-allgood-secondary hover:shadow-lg hover:-translate-y-1" onclick="logEvidence(this)">
                                        <div class="flex items-center gap-4">
                                            <div class="w-6 h-6 rounded border-2 border-gray-300 flex items-center justify-center transition-colors bg-gray-50">
                                                <i data-lucide="check" class="w-4 h-4 text-white opacity-0 transition-opacity stroke-[3]"></i>
                                            </div>
                                            <span class="text-base font-bold text-gray-600">Posted the content</span>
                                        </div>
                                        <span class="text-xs font-mono text-gray-400 bg-gray-100 px-2 py-1 rounded">+10XP</span>
                                    </div>
                                </div>

                                <!-- Graph -->
                                <div class="w-full max-w-sm mt-4 bg-white p-4 rounded-xl border border-gray-200 shadow-sm transform scale-100">
                                    <div class="flex justify-between text-[10px] uppercase font-bold text-gray-400 mb-2 tracking-wider">
                                        <span>Evidence Stack</span>
                                        <span id="stack-count">0/3</span>
                                    </div>
                                    <div class="evidence-bar bg-gray-100 border border-gray-200">
                                        <div class="evidence-fill" id="evidence-fill"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- PAGE 6: THE FEAR LOADOUT -->
                        <div class="page" id="page-6">
                            <div class="flex flex-col items-center justify-center h-full">
                                <div class="text-center mb-6">
                                    <h2 class="text-2xl font-heading font-bold text-allgood-dark">The Passenger Principle</h2>
                                    <p class="text-sm text-gray-500 mt-2">You can't delete fear. You have to carry it.</p>
                                </div>

                                <!-- Container -->
                                <div class="w-full max-w-md flex-1 bg-gray-100 rounded-xl border border-gray-300 relative overflow-hidden flex flex-col mb-4 shadow-inner transform scale-105">
                                    
                                    <!-- The Fear Item -->
                                    <div class="flex-1 flex items-center justify-center relative bg-white m-4 rounded-xl border-2 border-dashed border-gray-300" id="fear-zone">
                                        <div class="fear-item absolute w-24 h-24 bg-red-500 rounded-full flex flex-col items-center justify-center shadow-2xl cursor-grab active:cursor-grabbing z-20 border-4 border-red-400" 
                                             id="fear-blob">
                                            <i data-lucide="ghost" class="w-10 h-10 text-white mb-1 pointer-events-none"></i>
                                            <span class="text-xs font-bold text-white uppercase tracking-widest pointer-events-none">FEAR</span>
                                        </div>
                                        <div class="absolute bottom-3 right-3">
                                            <button class="p-3 bg-gray-50 rounded-lg text-gray-400 hover:text-red-500 hover:bg-red-50 transition-all border border-gray-200 shadow-sm" onclick="tryDeleteFear()">
                                                <i data-lucide="trash-2" class="w-6 h-6"></i>
                                            </button>
                                        </div>
                                    </div>

                                    <!-- The Backpack (Drop Zone) -->
                                    <div class="h-28 bg-allgood-dark text-white flex items-center justify-center gap-4 relative z-10 backpack-slot shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.3)]" id="backpack-zone">
                                        <div class="text-center pointer-events-none opacity-80">
                                            <i data-lucide="backpack" class="w-8 h-8 mx-auto mb-2 text-gray-300"></i>
                                            <span class="text-[10px] font-bold text-gray-300 uppercase tracking-widest">Drag Fear Here</span>
                                        </div>
                                    </div>

                                    <!-- GO Button (Locked initially) -->
                                    <div class="absolute inset-0 bg-black/80 z-30 flex items-center justify-center hidden backdrop-blur-sm" id="go-overlay">
                                        <button class="w-28 h-28 rounded-full bg-green-500 text-white font-bold text-2xl shadow-[0_0_30px_rgba(34,197,94,0.6)] animate-pulse hover:scale-105 transition-transform border-4 border-green-400" onclick="nextPage()">
                                            GO
                                        </button>
                                    </div>
                                </div>
                                
                                <div id="fear-feedback" class="text-sm font-bold text-red-500 h-6 text-center mt-2"></div>
                            </div>
                        </div>

                        <!-- PAGE 7: TINY TWEAK SLIDER -->
                        <div class="page" id="page-7">
                            <div class="flex flex-col items-center justify-center h-full">
                                <h2 class="text-2xl font-heading font-bold text-allgood-dark mb-4 text-center">The Tiny Tweak</h2>
                                <p class="text-sm text-gray-500 mb-6 text-center max-w-xs">Don't leap. Just shrink the monster.</p>

                                <div class="relative w-full max-w-xs h-28 flex items-center justify-center mb-3">
                                    <!-- The Monster (Scales) -->
                                    <div id="monster-task" class="transition-transform duration-300 flex flex-col items-center justify-center text-center">
                                        <div class="w-20 h-20 bg-allgood-primary rounded-2xl flex items-center justify-center shadow-xl mb-3 border-b-4 border-orange-700">
                                            <span class="text-3xl">üèîÔ∏è</span>
                                        </div>
                                        <span class="font-heading font-bold text-allgood-dark text-lg" id="monster-label">IMPOSSIBLE GOAL</span>
                                    </div>
                                </div>

                                <!-- Slider -->
                                <div class="w-full max-w-sm px-6">
                                    <!-- FIX: Reversed values to match direction (Right = Smaller/Better) -->
                                    <input type="range" min="1" max="100" value="1" class="w-full h-3 bg-gray-200 rounded-full appearance-none cursor-pointer accent-allgood-secondary shadow-inner" id="shrink-slider" oninput="updateMonster(this.value)">
                                    <div class="flex justify-between mt-3 text-[10px] font-bold text-gray-400 uppercase tracking-wider">
                                        <span>Big Leap</span>
                                        <span>Tiny Step</span>
                                    </div>
                                </div>

                                <div class="mt-4 p-4 bg-white border-l-4 border-allgood-secondary shadow-lg w-full max-w-sm opacity-0 transition-opacity rounded-r-lg" id="tweak-reveal">
                                    <p class="text-base text-gray-600 font-medium leading-snug">"I will write <span class="text-allgood-primary font-bold">one sentence</span>."</p>
                                </div>
                            </div>
                        </div>

                        <!-- PAGE 8: CTA (Updated to match Example Style) -->
                        <div class="page" id="page-8">
                            <div class="flex flex-col items-center justify-center text-center h-full px-4">
                                <h2 class="text-4xl font-heading font-bold mb-4 text-allgood-dark">Build a Better Board.</h2>
                                <p class="text-gray-600 mb-8 leading-relaxed text-lg max-w-md mx-auto">We're on a mission to build a better society by turning learning into <strong>pragmatic action</strong>.</p>
                                
                                <button onclick="window.open('https://allgoodacademy.com', '_blank')" class="w-full max-w-xs bg-allgood-primary text-white font-bold py-4 rounded-full shadow-lg uppercase tracking-widest text-sm hover:scale-105 transition-transform hover:bg-allgood-hover">
                                    Explore the Academy
                                </button>
                                
                                <div class="text-allgood-primary font-bold text-xl mt-6">allgoodacademy.com</div>
                                <p class="mt-4 text-xs text-gray-400 font-bold uppercase tracking-widest">Output Mechanic: Verified</p>
                                
                                <button onclick="location.reload()" class="mt-8 text-xs font-bold text-gray-300 hover:text-allgood-dark uppercase tracking-widest flex items-center gap-2">
                                    <i data-lucide="rotate-ccw" class="w-3 h-3"></i> Replay Module
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- 4. FOOTER -->
                <footer class="footer-content flex items-center justify-between px-6 border-t border-gray-200 bg-white z-20 relative h-[60px] shrink-0">
                    <div id="flex-progress-bar" class="absolute top-0 left-0 h-1 bg-gray-200 w-full"><div id="flex-progress-fill" class="h-full bg-allgood-primary w-0 transition-all duration-300"></div></div>
                    <button id="prev-btn" onclick="prevPage()" class="text-allgood-primary hover:text-allgood-dark font-bold text-sm flex items-center transition-colors disabled:opacity-30 disabled:cursor-not-allowed font-body">
                        <i data-lucide="chevron-left" class="w-4 h-4 mr-1"></i>Back
                    </button>
                    
                    <p class="text-gray-400 text-[10px] hidden sm:block font-body">&copy; <a href="https://www.allgoodacademy.com" target="_blank" class="hover:text-allgood-primary transition-colors font-bold">Allgood Academy</a> <span id="current-year"></span></p>

                    <button id="next-btn" onclick="nextPage()" class="bg-allgood-primary hover:bg-allgood-hover text-white px-6 py-2 rounded-full text-sm font-bold shadow-md transition-transform transform hover:scale-105 flex items-center disabled:opacity-50 disabled:cursor-not-allowed font-body">
                        <span>Next</span><i data-lucide="chevron-right" class="w-4 h-4 ml-1"></i>
                    </button>
                </footer>

                <!-- SYSTEM MENU (Identical to template) -->
                <div id="system-menu-modal" class="hidden-modal absolute inset-0 z-[250] bg-black/80 flex items-center justify-center p-6 modal-transition backdrop-blur-sm">
                    <div class="bg-white rounded-lg shadow-2xl p-8 max-w-sm w-full text-center border-t-4 border-gray-500">
                        <div class="mb-4">
                            <i data-lucide="settings" class="w-12 h-12 mx-auto text-gray-400"></i>
                        </div>
                        <h2 class="text-xl font-heading font-bold text-allgood-dark mb-2">System Menu</h2>
                        <p class="text-sm text-gray-500 mb-6 font-body">Select an option to proceed.</p>
                        
                        <div class="space-y-3">
                            <button onclick="location.reload()" class="w-full bg-red-50 hover:bg-red-100 text-red-600 font-bold py-3 rounded border border-red-200 shadow-sm transition-colors flex items-center justify-center">
                                <i data-lucide="power" class="w-4 h-4 mr-2"></i> Reset Mission
                            </button>
                            <button onclick="toggleMenu()" class="w-full text-gray-400 hover:text-gray-600 font-bold py-2 text-sm mt-2">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- AUDIO CONTEXT -->
    <script>
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function initAudio() {
            if (!audioCtx) audioCtx = new AudioContext();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playTone(freq, type, duration, vol = 0.1) {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        const sfx = {
            powerUp: () => {
                initAudio();
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.type = 'triangle'; // Gritty sound
                osc.frequency.setValueAtTime(110, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(220, audioCtx.currentTime + 0.5);
                gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            },
            nav: () => playTone(300, 'sine', 0.1, 0.1),
            success: () => {
                setTimeout(() => playTone(440, 'sine', 0.2), 0);
                setTimeout(() => playTone(554, 'sine', 0.4), 100);
            },
            error: () => playTone(150, 'sawtooth', 0.3, 0.2),
            click: () => playTone(800, 'square', 0.05, 0.05)
        };

        // STATE & NAV
        let currentPage = 1;
        const totalPages = 8;
        const jodiScripts = [
            "", // Startup
            "Welcome, Billy. Let's dismantle the biggest lie in self-improvement.",
            "You're stuck in the loop. Thinking about doing it doesn't count as doing it.",
            "Watch what happens when you change the fuel source.",
            "Drag the inputs. See which one actually powers the machine.",
            "Feel that? That's momentum. Every checkmark is a vote for your new identity.",
            "You can't delete fear. It's biological. But you can pack it away.",
            "Shrink the monster. If it's too scary, it's too big. Make it tiny.",
            "You did it. Now go do it for real."
        ];

        function updatePage() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${currentPage}`).classList.add('active');
            
            // Jodi Script
            const msg = document.getElementById('mentor-text');
            const bar = document.getElementById('mentor-bar');
            
            if (currentPage > 1) {
                bar.classList.remove('opacity-0');
                msg.innerText = jodiScripts[currentPage] || "...";
            } else {
                bar.classList.add('opacity-0');
            }
            
            // Progress Bar
            const progress = (currentPage / totalPages) * 100;
            document.getElementById('flex-progress-fill').style.width = `${progress}%`;
            document.getElementById('header-page-indicator').textContent = `${currentPage} / ${totalPages}`;

            // Button States
            document.getElementById('prev-btn').disabled = currentPage === 1;
            document.getElementById('next-btn').style.display = currentPage === 8 ? 'none' : 'flex';

            if(window.lucide) window.lucide.createIcons();
        }

        function nextPage() {
            if(currentPage < totalPages) {
                currentPage++;
                updatePage();
                sfx.nav();
            }
        }

        function prevPage() {
            if(currentPage > 1) {
                currentPage--;
                updatePage();
                sfx.nav();
            }
        }

        function goHome() {
            currentPage = 1;
            updatePage();
            sfx.powerUp();
        }

        // STARTUP
        document.getElementById('startup-screen').addEventListener('click', () => {
            sfx.powerUp();
            const screen = document.getElementById('startup-screen');
            screen.style.opacity = '0';
            setTimeout(() => {
                screen.style.display = 'none';
                updatePage();
            }, 800);
        });

        // PAGE 3: FLIP ANIMATION
        function animateFlip() {
            const btn = document.getElementById('diag-btn');
            if(btn.disabled) return;
            
            sfx.click();
            
            // Update button state immediately
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');
            btn.innerHTML = 'Running...';

            // Step 2 Reveal
            const s2 = document.getElementById('step-2');
            s2.classList.remove('opacity-0');
            document.getElementById('step-2-circle').classList.remove('bg-gray-600');
            document.getElementById('step-2-circle').classList.add('bg-allgood-primary', 'text-white');
            
            setTimeout(() => {
                sfx.success();
                // Step 3 Reveal
                const s3 = document.getElementById('step-3');
                s3.classList.remove('opacity-0');
                document.getElementById('step-3-circle').classList.remove('bg-gray-600');
                document.getElementById('step-3-circle').classList.add('bg-allgood-primary', 'text-white');
                
                // Finalize Button
                btn.innerHTML = '<i data-lucide="check" class="w-4 h-4 inline mr-2"></i>DIAGNOSTIC COMPLETE';
                if(window.lucide) window.lucide.createIcons();
            }, 800);
        }

        // --- UPDATED POINTER DRAG IMPLEMENTATION (NO HTML5 DnD) ---
        // This replaces the previous Drag and Drop API logic with robust pointer events
        
        function enableDrag(element, targetZone, onDropSuccess, onDropFail) {
            let startX = 0;
            let startY = 0;
            let initialLeft = 0;
            let initialTop = 0;
            let currentX = 0;
            let currentY = 0;
            let isDragging = false;
            
            // Store original position to snap back
            const originalTransform = element.style.transform;
            
            element.addEventListener('pointerdown', startDrag);
            
            function startDrag(e) {
                e.preventDefault();
                isDragging = true;
                
                // Capture element position relative to viewport
                const rect = element.getBoundingClientRect();
                initialLeft = rect.left;
                initialTop = rect.top;
                
                // Capture pointer position
                startX = e.clientX;
                startY = e.clientY;
                
                element.classList.add('dragging');
                element.setPointerCapture(e.pointerId);
                sfx.click();
                
                element.addEventListener('pointermove', onDrag);
                element.addEventListener('pointerup', endDrag);
            }
            
            function onDrag(e) {
                if (!isDragging) return;
                
                currentX = e.clientX - startX;
                currentY = e.clientY - startY;
                
                element.style.transform = `translate(${currentX}px, ${currentY}px)`;
                
                // Check collision with drop zone for visual feedback
                const draggableRect = element.getBoundingClientRect();
                const zoneRect = targetZone.getBoundingClientRect();
                
                if (isOverlapping(draggableRect, zoneRect)) {
                    targetZone.classList.add('drag-over');
                } else {
                    targetZone.classList.remove('drag-over');
                }
            }
            
            function endDrag(e) {
                if (!isDragging) return;
                isDragging = false;
                
                element.classList.remove('dragging');
                targetZone.classList.remove('drag-over');
                
                const draggableRect = element.getBoundingClientRect();
                const zoneRect = targetZone.getBoundingClientRect();
                
                if (isOverlapping(draggableRect, zoneRect)) {
                    // Success!
                    onDropSuccess(element);
                } else {
                    // Fail - Snap back
                    element.style.transition = 'transform 0.3s ease-out';
                    element.style.transform = 'translate(0, 0)';
                    
                    setTimeout(() => {
                        element.style.transition = '';
                        element.style.transform = originalTransform;
                    }, 300);
                    
                    if (onDropFail) onDropFail(element);
                }
                
                element.removeEventListener('pointermove', onDrag);
                element.removeEventListener('pointerup', endDrag);
                element.releasePointerCapture(e.pointerId);
            }
        }
        
        function isOverlapping(rect1, rect2) {
            return !(rect1.right < rect2.left || 
                     rect1.left > rect2.right || 
                     rect1.bottom < rect2.top || 
                     rect1.top > rect2.bottom);
        }

        // --- PAGE 4 SETUP ---
        const draggables = document.querySelectorAll('.draggable-orb');
        const inputSlot = document.getElementById('input-slot');
        const beam = document.getElementById('power-beam');
        const gauge = document.getElementById('output-gauge');
        const gaugeVal = document.getElementById('output-val');
        const gaugeLabel = document.getElementById('output-label');
        const systemStatus = document.getElementById('system-status');
        const feedback = document.getElementById('circuit-feedback');
        const flashMsg = document.getElementById('flash-message');

        draggables.forEach(d => {
            enableDrag(d, inputSlot, 
                // Success Callback
                (element) => {
                    const type = element.dataset.type;
                    
                    if (type === 'thought') {
                        sfx.error();
                        // Snap to slot center visually
                        element.style.transform = 'translate(0,0)'; 
                        
                        beam.style.width = '10%';
                        beam.style.background = '#94a3b8'; // Gray
                        beam.style.animation = 'none'; // No surge for error
                        
                        gauge.style.borderColor = '#94a3b8';
                        gaugeVal.innerText = '0%';
                        gaugeVal.classList.remove('text-allgood-primary', 'text-green-500');
                        
                        // UPDATED CONTEXTUAL FEEDBACK - No longer absolute positioning
                        systemStatus.innerText = "Error: Low Voltage";
                        systemStatus.className = "mt-2 text-center text-[10px] font-bold uppercase tracking-widest text-red-500 transition-colors duration-300 h-4";

                        feedback.innerHTML = "<strong>System Error:</strong> Thoughts are not fuel.<br>The engine requires <span class='text-red-600'>kinetic action</span>.";
                        feedback.className = "text-sm text-center mt-4 text-red-500 font-medium animate-pulse h-10 flex items-center justify-center";
                    } else {
                        sfx.success();
                        
                        // 1. Success Animation on Orb
                        element.style.transform = 'translate(0,0)';
                        element.style.animation = 'pulse-success 0.5s ease-out';
                        element.classList.add('border-green-500', 'border-2');
                        
                        // 2. Immediate Gauge Snap
                        gauge.style.borderColor = '#D34716'; // Allgood Orange for Gauge Ring
                        gauge.style.transition = 'border-color 0.2s ease-out';
                        
                        gaugeVal.innerText = '100%';
                        gaugeVal.classList.add('text-allgood-primary'); // Orange Text
                        
                        gaugeLabel.classList.remove('text-gray-400');
                        gaugeLabel.classList.add('text-allgood-primary');

                        // 3. Status Text Update - No longer absolute positioning
                        systemStatus.innerHTML = "<span class='text-green-600'>SYSTEM ONLINE</span>";
                        systemStatus.className = "mt-2 text-center text-[10px] font-bold uppercase tracking-widest transition-colors duration-300 h-4";

                        // 4. Flash Message
                        flashMsg.innerText = "KINETIC ENERGY RECEIVED"; // More technical/contextual
                        flashMsg.style.animation = 'flash-fade 2s ease-out forwards';
                        
                        // 5. Beam Surge
                        beam.style.background = 'linear-gradient(90deg, #D34716, #fb923c)';
                        beam.style.animation = 'surge-beam 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards';
                        
                        // UPDATED CONTEXTUAL FEEDBACK
                        feedback.innerHTML = "<strong>Output Generated.</strong><br>Action creates the feeling.";
                        feedback.className = "text-sm text-center mt-4 text-allgood-primary font-bold h-10 flex items-center justify-center";
                        
                        // 6. Hide Orb after effect
                        setTimeout(() => {
                            element.style.opacity = '0';
                            element.style.pointerEvents = 'none';
                        }, 600);
                    }
                },
                // Fail Callback
                null
            );
        });

        // --- PAGE 6 SETUP ---
        const fearBlob = document.getElementById('fear-blob');
        const backpackZone = document.getElementById('backpack-zone');
        const fearFeedback = document.getElementById('fear-feedback');
        
        enableDrag(fearBlob, backpackZone,
            // Success
            (element) => {
                sfx.success();
                
                // Physically move DOM element to backpack to lock it
                backpackZone.innerHTML = '';
                // Clone needed because event listeners might be weird if moved directly during pointer up
                const clone = element.cloneNode(true);
                clone.style.transform = 'scale(0.8)';
                clone.style.position = 'static';
                clone.classList.remove('absolute');
                backpackZone.appendChild(clone);
                
                // Hide original container content
                document.getElementById('fear-zone').innerHTML = '<p class="text-xs text-gray-300 italic">Empty</p>';
                
                fearFeedback.innerText = "Fear packed. You are ready to move.";
                fearFeedback.classList.remove('text-red-500');
                fearFeedback.classList.add('text-green-600');
                
                document.getElementById('go-overlay').classList.remove('hidden');
            },
            // Fail (used for initial clear)
            () => {
               fearFeedback.innerText = "";
            }
        );

        function tryDeleteFear() {
            sfx.error();
            fearFeedback.innerText = "ERROR: Cannot delete primal emotion.";
            fearBlob.classList.add('animate-bounce');
            setTimeout(() => fearBlob.classList.remove('animate-bounce'), 500);
        }

        // PAGE 5: EVIDENCE LOG
        let evidenceCount = 0;
        function logEvidence(el) {
            if(el.classList.contains('bg-green-50')) return; // Already clicked
            
            sfx.click();
            el.classList.remove('bg-white');
            el.classList.add('bg-green-50', 'border-green-200');
            
            // Fix: Lucide replaces <i> with <svg>, so query for svg if i is missing
            const icon = el.querySelector('svg') || el.querySelector('i');
            if(icon) icon.classList.remove('opacity-0');
            
            // Fix: The box size was changed to w-5, so .w-6 selector was failing. 
            // Better to target the border div directly.
            const box = el.querySelector('.border-2'); 
            if(box) box.classList.add('bg-green-500', 'border-green-500');
            
            evidenceCount++;
            document.getElementById('stack-count').innerText = `${evidenceCount}/3`;
            document.getElementById('evidence-fill').style.width = `${(evidenceCount/3)*100}%`;

            if(evidenceCount === 3) sfx.success();
        }

        // PAGE 7: TINY TWEAK
        function updateMonster(val) {
            // FIX: Reverse Logic (1 = Small, 100 = Big) but Slider direction (Left to Right)
            // Left (val=1): Impossible (Big Mountain)
            // Right (val=100): Tiny (Pebble)
            
            // To achieve "Drag right to shrink":
            // Slider Value: 1 (Left) -> 100 (Right)
            // Scale: 1 (Big) -> 0.3 (Small)
            
            const scale = 1 - (val / 100 * 0.7); // Maps 0->100 to 1->0.3
            const monster = document.getElementById('monster-task');
            const label = document.getElementById('monster-label');
            const reveal = document.getElementById('tweak-reveal');

            monster.style.transform = `scale(${Math.max(0.3, scale)})`;
            
            if (val < 40) {
                label.innerText = "IMPOSSIBLE GOAL";
                reveal.classList.remove('opacity-100');
            } else if (val < 80) {
                label.innerText = "Hard Project";
            } else {
                label.innerText = "Tiny Task";
                reveal.classList.add('opacity-100');
                if(!reveal.dataset.played) {
                    sfx.click();
                    reveal.dataset.played = "true";
                }
            }
        }

        // SYSTEM TOGGLES
        function toggleBlueprint() {
            document.body.classList.toggle('blueprint-mode');
            sfx.nav();
        }
        function toggleFullscreen() {
            document.getElementById('main-frame').classList.toggle('focus-mode');
            sfx.nav();
        }
        function toggleMenu() {
            const menu = document.getElementById('system-menu-modal');
            if(menu.classList.contains('hidden-modal')) {
                menu.classList.remove('hidden-modal');
                menu.classList.add('visible-modal');
            } else {
                menu.classList.add('hidden-modal');
                menu.classList.remove('visible-modal');
            }
            sfx.nav();
        }
        
        // HOME LONG PRESS LOGIC
        const homeBtn = document.getElementById('home-button');
        let pressTimer;
        homeBtn.addEventListener('mousedown', () => {
            pressTimer = setTimeout(() => {
                toggleMenu();
            }, 800);
        });
        homeBtn.addEventListener('mouseup', () => clearTimeout(pressTimer));
        homeBtn.addEventListener('mouseleave', () => clearTimeout(pressTimer));

        // Init Icons
        if(window.lucide) window.lucide.createIcons();
        document.getElementById('current-year').innerText = new Date().getFullYear();

    </script>
</body>
</html>
